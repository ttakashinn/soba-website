---
import { getLangFromUrl } from '../i18n/utils'

const lang = getLangFromUrl(Astro.url)

const content = {
  vi: {
    badge: 'MIỄN PHÍ',
    title: 'Đánh giá độ sẵn sàng chuyển đổi số',
    benefits: [
      'Phân tích điểm mạnh/yếu hệ thống',
      'Roadmap 12 tháng',
      'Ước tính chi phí & ROI',
      '30 phút tư vấn 1-1',
    ],
    originalPrice: 'Giá trị: 5 triệu',
    freeText: 'MIỄN PHÍ tháng này',
    cta: 'Đặt lịch ngay',
    slotsLeft: 'Còn 5 slot',
  },
  en: {
    badge: 'FREE',
    title: 'Digital Transformation Readiness Assessment',
    benefits: [
      'System strengths/weaknesses analysis',
      '12-month roadmap',
      'Cost & ROI estimation',
      '30-minute 1-on-1 consultation',
    ],
    originalPrice: 'Value: $200',
    freeText: 'FREE this month',
    cta: 'Book Now',
    slotsLeft: '5 slots left',
  },
  ja: {
    badge: '無料',
    title: 'DX準備度評価',
    benefits: [
      'システムの強み/弱み分析',
      '12ヶ月のロードマップ',
      'コスト＆ROI見積もり',
      '30分の1対1コンサルティング',
    ],
    originalPrice: '価値: 3万円',
    freeText: '今月無料',
    cta: '今すぐ予約',
    slotsLeft: '残り5枠',
  },
}

const currentContent = content[lang as keyof typeof content] || content.vi
const contactUrl = lang === 'vi' ? '/contact' : `/${lang}/contact`
---

<div
  x-data='{ show: true, dismissed: false }'
  x-show='show && !dismissed'
  x-transition:enter='transition ease-out duration-300'
  x-transition:enter-start='opacity-0 transform translate-y-4'
  x-transition:enter-end='opacity-100 transform translate-y-0'
  x-transition:leave='transition ease-in duration-200'
  x-transition:leave-start='opacity-100'
  x-transition:leave-end='opacity-0'
  class='relative'>
  <section class='bg-gradient-to-r from-indigo-600 via-indigo-700 to-violet-700 py-6 sm:py-8 lg:py-10 overflow-hidden'>
    <!-- Background pattern -->
    <div class='absolute inset-0 opacity-10'>
      <div
        class='absolute inset-0'
        style='background-image: radial-gradient(circle at 2px 2px, white 1px, transparent 0); background-size: 30px 30px;'
      ></div>
    </div>

    <!-- Animated glow -->
    <div
      class='absolute -top-20 -right-20 w-40 sm:w-60 h-40 sm:h-60 bg-white rounded-full opacity-10 blur-3xl animate-pulse'
    ></div>
    <div
      class='absolute -bottom-20 -left-20 w-40 sm:w-60 h-40 sm:h-60 bg-violet-300 rounded-full opacity-10 blur-3xl animate-pulse'
      style='animation-delay: 1s;'></div>

    <div class='relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'>
      <div class='flex flex-col lg:flex-row items-center justify-between gap-6'>
        <!-- Content -->
        <div class='flex-1 text-center lg:text-left'>
          <div
            class='inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm text-white font-semibold px-4 py-1.5 rounded-full text-xs sm:text-sm mb-3 sm:mb-4'>
            <span class='w-2 h-2 bg-emerald-400 rounded-full animate-pulse'></span>
            {currentContent.badge}
          </div>

          <h3 class='text-xl sm:text-2xl lg:text-3xl font-bold text-white mb-3 sm:mb-4'>
            {currentContent.title}
          </h3>

          <div class='flex flex-wrap justify-center lg:justify-start gap-x-4 sm:gap-x-6 gap-y-2 text-white/90 text-sm sm:text-base'>
            {
              currentContent.benefits.map((benefit) => (
                <div class='flex items-center gap-2'>
                  <svg class='w-4 h-4 text-emerald-400 shrink-0' fill='currentColor' viewBox='0 0 20 20'>
                    <path
                      fill-rule='evenodd'
                      d='M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z'
                      clip-rule='evenodd'
                    />
                  </svg>
                  <span>{benefit}</span>
                </div>
              ))
            }
          </div>
        </div>

        <!-- CTA -->
        <div class='shrink-0 text-center'>
          <div class='mb-3'>
            <span class='text-indigo-200 line-through text-sm sm:text-base'>{currentContent.originalPrice}</span>
            <span class='text-white font-bold text-base sm:text-lg ml-2'>→ {currentContent.freeText}</span>
          </div>

          <a
            href={contactUrl}
            class='inline-flex items-center gap-2 bg-white text-indigo-700 px-6 sm:px-8 py-3 sm:py-3.5 rounded-xl font-semibold text-sm sm:text-base hover:bg-indigo-50 transition-all duration-300 shadow-lg shadow-indigo-900/20 hover:shadow-xl hover:scale-105 btn-press'>
            {currentContent.cta}
            <svg class='w-4 h-4 sm:w-5 sm:h-5' fill='none' stroke='currentColor' viewBox='0 0 24 24'>
              <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17 8l4 4m0 0l-4 4m4-4H3'
              ></path>
            </svg>
          </a>

          <div class='mt-2 sm:mt-3 text-indigo-200 text-xs sm:text-sm font-medium flex items-center justify-center gap-2'>
            <span class='inline-block w-1.5 h-1.5 bg-emerald-400 rounded-full animate-pulse'></span>
            {currentContent.slotsLeft}
          </div>
        </div>
      </div>
    </div>
  </section>
</div>
