---
import { getLangFromUrl } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);

const content = {
  vi: {
    badge: 'ğŸ MIá»„N PHÃ',
    title: 'ÄÃ¡nh giÃ¡ Ä‘á»™ sáºµn sÃ ng chuyá»ƒn Ä‘á»•i sá»‘',
    benefits: [
      'PhÃ¢n tÃ­ch Ä‘iá»ƒm máº¡nh/yáº¿u há»‡ thá»‘ng',
      'Roadmap 12 thÃ¡ng',
      'Æ¯á»›c tÃ­nh chi phÃ­ & ROI',
      '30 phÃºt tÆ° váº¥n 1-1'
    ],
    originalPrice: 'GiÃ¡ trá»‹: 5 triá»‡u',
    freeText: 'MIá»„N PHÃ thÃ¡ng nÃ y',
    cta: 'Äáº·t lá»‹ch ngay',
    slotsLeft: 'CÃ²n 5 slot'
  },
  en: {
    badge: 'ğŸ FREE',
    title: 'Digital Transformation Readiness Assessment',
    benefits: [
      'System strengths/weaknesses analysis',
      '12-month roadmap',
      'Cost & ROI estimation',
      '30-minute 1-on-1 consultation'
    ],
    originalPrice: 'Value: $200',
    freeText: 'FREE this month',
    cta: 'Book Now',
    slotsLeft: '5 slots left'
  },
  ja: {
    badge: 'ğŸ ç„¡æ–™',
    title: 'DXæº–å‚™åº¦è©•ä¾¡',
    benefits: [
      'ã‚·ã‚¹ãƒ†ãƒ ã®å¼·ã¿/å¼±ã¿åˆ†æ',
      '12ãƒ¶æœˆã®ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—',
      'ã‚³ã‚¹ãƒˆï¼†ROIè¦‹ç©ã‚‚ã‚Š',
      '30åˆ†ã®1å¯¾1ã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°'
    ],
    originalPrice: 'ä¾¡å€¤: 3ä¸‡å††',
    freeText: 'ä»Šæœˆç„¡æ–™',
    cta: 'ä»Šã™ãäºˆç´„',
    slotsLeft: 'æ®‹ã‚Š5æ '
  }
};

const currentContent = content[lang as keyof typeof content] || content.vi;
const contactUrl = lang === 'vi' ? '/contact' : `/${lang}/contact`;
---

<div
  x-data="{ show: true, dismissed: false }"
  x-show="show && !dismissed"
  x-transition:enter="transition ease-out duration-300"
  x-transition:enter-start="opacity-0 transform translate-y-4"
  x-transition:enter-end="opacity-100 transform translate-y-0"
  x-transition:leave="transition ease-in duration-200"
  x-transition:leave-start="opacity-100"
  x-transition:leave-end="opacity-0"
  class="relative"
>
  <section class="bg-linear-to-r from-blue-600 via-blue-700 to-purple-700 py-8 lg:py-10 overflow-hidden">
    <!-- Background pattern -->
    <div class="absolute inset-0 opacity-10">
      <div class="absolute inset-0" style="background-image: radial-gradient(circle at 2px 2px, white 1px, transparent 0); background-size: 30px 30px;"></div>
    </div>

    <!-- Animated glow -->
    <div class="absolute -top-20 -right-20 w-60 h-60 bg-yellow-400 rounded-full opacity-20 blur-3xl animate-pulse"></div>
    <div class="absolute -bottom-20 -left-20 w-60 h-60 bg-blue-300 rounded-full opacity-20 blur-3xl animate-pulse" style="animation-delay: 1s;"></div>

    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex flex-col lg:flex-row items-center justify-between gap-6">
        <!-- Content -->
        <div class="flex-1 text-center lg:text-left">
          <div class="inline-flex items-center gap-2 bg-yellow-400 text-gray-900 font-bold px-4 py-1 rounded-full text-sm mb-4 animate-bounce">
            {currentContent.badge}
          </div>

          <h3 class="text-2xl lg:text-3xl font-bold text-white mb-4">
            {currentContent.title}
          </h3>

          <div class="flex flex-wrap justify-center lg:justify-start gap-x-6 gap-y-2 text-blue-100">
            {currentContent.benefits.map((benefit) => (
              <div class="flex items-center gap-2">
                <span class="text-green-400">âœ…</span>
                <span>{benefit}</span>
              </div>
            ))}
          </div>
        </div>

        <!-- CTA -->
        <div class="flex-shrink-0 text-center">
          <div class="mb-3">
            <span class="text-blue-200 line-through text-lg">{currentContent.originalPrice}</span>
            <span class="text-yellow-400 font-bold text-xl ml-2">â†’ {currentContent.freeText}</span>
          </div>

          <a
            href={contactUrl}
            class="inline-flex items-center gap-2 bg-white text-blue-700 px-8 py-4 rounded-xl font-bold text-lg hover:bg-yellow-400 hover:text-gray-900 transition-all duration-300 shadow-2xl hover:shadow-yellow-400/30 hover:scale-105"
          >
            {currentContent.cta}
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
            </svg>
          </a>

          <div class="mt-3 text-yellow-300 text-sm font-medium flex items-center justify-center gap-2">
            <span class="inline-block w-2 h-2 bg-yellow-400 rounded-full animate-pulse"></span>
            {currentContent.slotsLeft}
          </div>
        </div>

        <!-- Close button -->
        <!-- <button
          @click="dismissed = true"
          class="absolute top-0 right-0 text-white/60 hover:text-white transition-colors p-2"
          aria-label="ÄÃ³ng"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button> -->
      </div>
    </div>
  </section>
</div>
